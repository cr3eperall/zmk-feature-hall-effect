# Copyright (c) 2020, Pete Johanson
# SPDX-License-Identifier: MIT

description: Analog key kscan controller

compatible: "zmk,kscan-adc-direct"

include: kscan.yaml

properties:
  resolution:
    type: int
    default: 12
    enum:
      - 8
      - 10
      - 12
  pulse-read:
    type: boolean
  read-turn-on-time:
    description: Time to wait before reading the key after turning it on
    type: int
    default: 100
  wait-period-idle:
    type: int
    default: 5
  wait-period-press:
    type: int
    default: 1

child-binding:
  description: Per enable-gpio group configuration
  properties:
    enable-gpios:
      type: phandle-array
    switch-pressed-is-higher: #TODO change to lower if needed
      type: boolean
    switch-height:
      description: Height of the switch in micrometers
      type: int
      default: 3300
      
  child-binding:
    description: Per key configuration
    properties:
      io-channels:
        description: ADC channel for this key
        type: phandle-array
        required: true
      press-point:
        type: int
        description: Threshold to consider a key as pressed in micrometers from the top
        default: 2500
      release-point:
        type: int
        description: Threshold to consider a key as released in micrometers from the top
        default: 3000
      calibration-min:
        type: int
        description: Minimum value to consider for calibration
        default: 0
      calibration-max:
        type: int
        description: Maximum value to consider for calibration
        default: 0
        

